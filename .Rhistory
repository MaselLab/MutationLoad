theme_Publication(base_size=text_size) +
theme(legend.position="none",
axis.title.x=element_blank(),  # remove x-axis for top row
axis.text.x=element_blank(),
axis.title.y=element_blank(),  # remove y-axis for top row
axis.text.y=element_blank(),
plot.margin=margin(.5,.5,.5,.5))
#p5 #offset del ratio
p5 <- ggplot() +
geom_line(data = dat_sb_highoffset_1000,
aes(x=sb, y=1.5e-5/abs(del_flux-1.5e-5), col="1000", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sb_highoffset_100,
aes(x=sb, y=1.5e-5/abs(del_flux-1.5e-5), col="100", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sb_lowoffset_1000,
aes(x=sb, y=1e-6/abs(del_flux-1e-6), col="1000", linetype="Low offset"), linewidth =line_width)+
geom_line(data = dat_sb_lowoffset_100,
aes(x=sb, y=1e-6/abs(del_flux-1e-6), col="100", linetype="Low offset"), linewidth =line_width)+
scale_x_log10(breaks = c(0.001, 0.01), labels = c("0.001", "0.01")) +
annotation_logticks(sides = "bl",short = unit(0.25, "mm"),
mid = unit(0.5, "mm"),
long = unit(1, "mm"),
outside=TRUE)+ coord_cartesian(clip="off")+
scale_y_log10(breaks=c(0.01, 0.1, 1), labels=c("0.01","0.1","1")) +
geom_hline(aes(yintercept =1), linetype="dotted", alpha=0.5, col="red", linewidth=line_width)+
scale_colour_manual(values=c("1000"="#9e9e9e","100"="#2298e6")) +
scale_linetype_manual(values=c("High offset"="solid", "Low offset"="dashed")) +
labs(y=expression("Env. ch. to mut. deg. ratio at "*N[crit])) +
theme_Publication(base_size=text_size) +
theme(legend.position="none",
axis.title.x=element_blank(),  # remove x-axis for top row
axis.text.x=element_blank(),
axis.title.y=element_blank(),  # remove y-axis for top row
axis.text.y=element_blank(),
plot.margin=margin(.5,.5,.5,.5))
#p6 #Ncrit
p6 <- ggplot() +
geom_line(data = dat_sb_highoffset_1000,
aes(x=sb, y=Ncrit, col="1000", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sb_highoffset_100,
aes(x=sb, y=Ncrit, col="100", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sb_lowoffset_1000,
aes(x=sb, y=Ncrit, col="1000", linetype="Low offset"), linewidth =line_width)+
geom_line(data = dat_sb_lowoffset_100,
aes(x=sb, y=Ncrit, col="100", linetype="Low offset"), linewidth =line_width)+
geom_point(aes(x=0.001,y=1834.57),col = "#F05039",shape=42, size=7)+
scale_x_log10(name=expression(bold(s[b])), breaks = c(0.001, 0.01), labels = c("0.001", "0.01")) +
annotation_logticks(sides = "bl",short = unit(0.25, "mm"),
mid = unit(0.5, "mm"),
long = unit(1, "mm"),
outside=TRUE)+ coord_cartesian(clip="off")+
scale_y_log10(limits=c(70, 5700), labels = label_number(big.mark = "\u202F")) +
scale_colour_manual(values=c("1000"="#9e9e9e","100"="#2298e6")) +
scale_linetype_manual(values=c("High offset"="solid", "Low offset"="dashed")) +
labs(y=expression(N[crit])) +
theme_Publication(base_size=text_size) +
theme(legend.position="none",
axis.title.y=element_blank(),  # remove y-axis for top row
axis.text.y=element_blank(),
plot.margin=margin(.5,.5,.5,.5))
# Combine plots in 2 columns x 3 rows
combined <- (p1 | p4) / (p2 | p5) / (p3 | p6) +
plot_annotation(tag_levels = "a", tag_prefix = "(", tag_suffix = ")") &
theme(plot.tag = element_text(family="Times New Roman", face="italic", size=9))
# Save as Proceedings B single-column figure (88 mm = 3.46 inches)
tiff("figureS3_combined_1col.tiff",
width = 4, height = 6,  # adjust height for readability
units = "in", res = 600, compression = "lzw")
print(combined)
dev.off()
#plotting fluxes
p1 <- ggplot(change_in_L, aes(x = nchr, y = Ncrit)) +
geom_point(size=2) +
geom_hline(yintercept = 1834.57, col="red", linetype="dotted", linewidth = line_width) +
scale_x_log10(breaks = c(10,100,1000,10000), labels = c("10","100","1000","10000")) +
labs(x = "Number of Chromosomes", y = expression(bold(N[crit]))) +
theme_Publication(base_size = 9) +
theme(plot.margin = margin(5,5,5,5))
p2 <- ggplot(change_in_L, aes(x = nchr, y = ratio)) +
geom_point(size=2) +
geom_hline(yintercept = 0.85, col="red", linetype="dotted", linewidth = line_width) +
scale_x_log10(breaks = c(10,100,1000,10000), labels = c("10","100","1000","10000")) +
ylim(0, 1.13) +
labs(x = "Number of Chromosomes", y = "Drought:Meltdown ratio") +
theme_Publication(base_size = 9) +
theme(plot.margin = margin(5,5,5,5))
# Combine plots in 2 columns x 3 rows
combined <- (p1 / p2) +
plot_annotation(tag_levels = "a", tag_prefix = "(", tag_suffix = ")") &
theme(plot.tag = element_text(family="Times New Roman", face="italic", size=9))
# Save as Proceedings B single-column figure (88 mm = 3.46 inches)
tiff("figureS4_combined_1col.tiff",
width = 4, height = 6,  # adjust height for readability
units = "in", res = 600, compression = "lzw")
print(combined)
dev.off()
p
p
p
#plotting fluxes
p1 <- ggplot(change_in_L, aes(x = nchr, y = Ncrit)) +
geom_point(size=2) +
geom_hline(yintercept = 1834.57, col="red", linetype="dotted", linewidth = line_width) +
labs(x = "Number of Chromosomes", y = expression(bold(N[crit]))) +
theme_Publication(base_size = 9) +
theme(plot.margin = margin(5,5,5,5))
p2 <- ggplot(change_in_L, aes(x = nchr, y = ratio)) +
geom_point(size=2) +
geom_hline(yintercept = 0.85, col="red", linetype="dotted", linewidth = line_width) +
ylim(0, 1.13) +
labs(x = "Number of Chromosomes", y = "Drought:Meltdown ratio") +
theme_Publication(base_size = 9) +
theme(plot.margin = margin(5,5,5,5))
# Combine plots in 2 columns x 3 rows
combined <- (p1 / p2) +
plot_annotation(tag_levels = "a", tag_prefix = "(", tag_suffix = ")") &
theme(plot.tag = element_text(family="Times New Roman", face="italic", size=9))
# Save as Proceedings B single-column figure (88 mm = 3.46 inches)
tiff("figureS4_combined_1col.tiff",
width = 4, height = 6,  # adjust height for readability
units = "in", res = 600, compression = "lzw")
print(combined)
dev.off()
# Save as Proceedings B single-column figure (88 mm = 3.46 inches)
tiff("figureS4_combined_1col.tiff",
width = 4, height = 5,  # adjust height for readability
units = "in", res = 600, compression = "lzw")
print(combined)
dev.off()
# Save as Proceedings B single-column figure (88 mm = 3.46 inches)
tiff("figureS4_combined_1col.tiff",
width = 3, height = 6,  # adjust height for readability
units = "in", res = 600, compression = "lzw")
print(combined)
dev.off()
# Save as Proceedings B single-column figure (88 mm = 3.46 inches)
tiff("figureS4_combined_1col.tiff",
width = 3, height = 5,  # adjust height for readability
units = "in", res = 600, compression = "lzw")
print(combined)
dev.off()
#######set preferred theme########
library(ggplot2)
library(dplyr)
library(scales)
library(gridExtra)
library(ggpubr)
library(ggridges)
library(plyr)
library(corrplot)
library(latex2exp)
library(ggallin)
library(extrafont)
library(patchwork)
library(cowplot)
loadfonts(device = "win")
loadfonts(device = "pdf")
theme_Publication <- function(base_size=9, base_family="Times New Roman") {
library(grid)
library(ggthemes)
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
plot.tag = element_text(family = base_family, face = "italic", size = base_size),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.2, "cm"),
legend.spacing = unit(0, "cm"),
legend.title = element_text(face="italic"),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
scale_fill_Publication <- function(...){
library(scales)
discrete_scale("fill","Publication",
manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c",
"#662506","#a6cee3","#fb9a99","#984ea3",
"#ffff33")), ...)
}
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",
manual_pal(values = c("#386cb0","#fdb462","#7fc97f",
"#ef3b2c","#662506","#a6cee3","#fb9a99",
"#984ea3","#ffff33")), ...)
}
save_procb <- function(plot, filename, col = c("1col", "2col"), height_mm = 100) {
col <- match.arg(col)
width_mm <- ifelse(col == "1col", 80, 167)   # Proceedings B column widths
ggsave(filename, plot = plot,
width = width_mm/25.4, height = height_mm/25.4,
units = "in", dpi = 600,
compression = "lzw", device = "tiff")
}
label_thinspace <- label_number(
big.mark = "\u2009",  # Unicode thin space
decimal.mark = "."
)
theme_set(theme_Publication())
setwd("analytical_data/")
#ben del ratio
#p1
p1 <- ggplot() +
geom_line(data = dat_sd_highoffset_1000[-21,],
aes(x=sd, y=bendelratio, col="1000", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sd_highoffset_100[-21,],
aes(x=sd, y=bendelratio, col="100", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sd_lowoffset_1000[-21,],
aes(x=sd, y=bendelratio, col="1000", linetype="Low offset"), linewidth =line_width)+
geom_line(data = dat_sd_lowoffset_100[-21,],
aes(x=sd, y=bendelratio, col="100", linetype="Low offset"), linewidth =line_width)+
geom_point(aes(x=0.009487042205869916,y=0.853449),col = "#F05039",shape=42, size=7)+
scale_x_log10(name=NULL, limits=c(0.001,0.1), breaks = c(0.001, 0.01, 0.1), labels=c("0.001", "0.01", "0.1")) +
annotation_logticks(sides = "bl",short = unit(0.5, "mm"),
mid = unit(0.75, "mm"),
long = unit(1.25, "mm"),
outside=TRUE)+ coord_cartesian(clip="off")+
geom_hline(aes(yintercept =1), linetype="dotted", alpha=0.5, col="red", linewidth=line_width)+
scale_y_log10(limits=c(0.78,2.5)) +
scale_colour_manual(values=c("1000"="#9e9e9e","100"="#2298e6")) +
scale_linetype_manual(values=c("High offset"="solid", "Low offset"="dashed")) +
labs(y="Drought:Meltdown ratio") +
theme_Publication(base_size=text_size) +
theme(legend.position="none",
axis.title.x=element_blank(),  # remove x-axis for top row
axis.text.x=element_blank(),
plot.margin=margin(.5,.5,.5,.5))
p1
#ben del ratio
#p1
p1 <- ggplot() +
geom_line(data = dat_sd_highoffset_1000[-21,],
aes(x=sd, y=bendelratio, col="1000", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sd_highoffset_100[-21,],
aes(x=sd, y=bendelratio, col="100", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sd_lowoffset_1000[-21,],
aes(x=sd, y=bendelratio, col="1000", linetype="Low offset"), linewidth =line_width)+
geom_line(data = dat_sd_lowoffset_100[-21,],
aes(x=sd, y=bendelratio, col="100", linetype="Low offset"), linewidth =line_width)+
geom_point(aes(x=0.009487042205869916,y=0.853449),col = "#F05039",shape=42, size=7)+
scale_x_log10(name=NULL, limits=c(0.001,0.1), breaks = c(0.001, 0.01, 0.1), labels=c("0.001", "0.01", "0.1")) +
annotation_logticks(sides = "bl",short = unit(0.5, "mm"),
mid = unit(0.75, "mm"),
long = unit(1.25, "mm"),
outside=TRUE)+ coord_cartesian(clip="off")+
geom_hline(aes(yintercept =1), linetype="dotted", alpha=0.5, col="red", linewidth=line_width)+
#scale_y_log10(limits=c(0.78,2.5)) +
scale_colour_manual(values=c("1000"="#9e9e9e","100"="#2298e6")) +
scale_linetype_manual(values=c("High offset"="solid", "Low offset"="dashed")) +
labs(y="Drought:Meltdown ratio") +
theme_Publication(base_size=text_size) +
theme(legend.position="none",
axis.title.x=element_blank(),  # remove x-axis for top row
axis.text.x=element_blank(),
plot.margin=margin(.5,.5,.5,.5))
p1
#######set preferred theme########
library(ggplot2)
library(dplyr)
library(scales)
library(gridExtra)
library(ggpubr)
library(ggridges)
library(plyr)
library(corrplot)
library(latex2exp)
library(ggallin)
library(extrafont)
library(patchwork)
library(cowplot)
loadfonts(device = "win")
loadfonts(device = "pdf")
theme_Publication <- function(base_size=9, base_family="Times New Roman") {
library(grid)
library(ggthemes)
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
plot.tag = element_text(family = base_family, face = "italic", size = base_size),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.2, "cm"),
legend.spacing = unit(0, "cm"),
legend.title = element_text(face="italic"),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
scale_fill_Publication <- function(...){
library(scales)
discrete_scale("fill","Publication",
manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c",
"#662506","#a6cee3","#fb9a99","#984ea3",
"#ffff33")), ...)
}
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",
manual_pal(values = c("#386cb0","#fdb462","#7fc97f",
"#ef3b2c","#662506","#a6cee3","#fb9a99",
"#984ea3","#ffff33")), ...)
}
save_procb <- function(plot, filename, col = c("1col", "2col"), height_mm = 100) {
col <- match.arg(col)
width_mm <- ifelse(col == "1col", 80, 167)   # Proceedings B column widths
ggsave(filename, plot = plot,
width = width_mm/25.4, height = height_mm/25.4,
units = "in", dpi = 600,
compression = "lzw", device = "tiff")
}
label_thinspace <- label_number(
big.mark = "\u2009",  # Unicode thin space
decimal.mark = "."
)
theme_set(theme_Publication())
setwd("analytical_data/")
#ben del ratio
#p1
p1 <- ggplot() +
geom_line(data = dat_sd_highoffset_1000[-21,],
aes(x=sd, y=bendelratio, col="1000", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sd_highoffset_100[-21,],
aes(x=sd, y=bendelratio, col="100", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sd_lowoffset_1000[-21,],
aes(x=sd, y=bendelratio, col="1000", linetype="Low offset"), linewidth =line_width)+
geom_line(data = dat_sd_lowoffset_100[-21,],
aes(x=sd, y=bendelratio, col="100", linetype="Low offset"), linewidth =line_width)+
geom_point(aes(x=0.009487042205869916,y=0.853449),col = "#F05039",shape=42, size=7)+
scale_x_log10(name=NULL, limits=c(0.001,0.1), breaks = c(0.001, 0.01, 0.1), labels=c("0.001", "0.01", "0.1")) +
annotation_logticks(sides = "bl",short = unit(0.5, "mm"),
mid = unit(0.75, "mm"),
long = unit(1.25, "mm"),
outside=TRUE)+ coord_cartesian(clip="off")+
geom_hline(aes(yintercept =1), linetype="dotted", alpha=0.5, col="red", linewidth=line_width)+
scale_y_log10(limits=c(0.35,18.5), breaks=c(1,3,10), labels=c("1","3","10")) +
scale_colour_manual(values=c("1000"="#9e9e9e","100"="#2298e6")) +
scale_linetype_manual(values=c("High offset"="solid", "Low offset"="dashed")) +
labs(y="Drought:Meltdown ratio") +
theme_Publication(base_size=text_size) +
theme(legend.position="none",
axis.title.x=element_blank(),  # remove x-axis for top row
axis.text.x=element_blank(),
plot.margin=margin(.5,.5,.5,.5))
#p2 #offset del ratio
p2 <- ggplot() +
geom_line(data = dat_sd_highoffset_1000[-21,],
aes(x=sd, y=1.5e-5/abs(del_flux-1.5e-5), col="1000", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sd_highoffset_100[-21,],
aes(x=sd, y=1.5e-5/abs(del_flux-1.5e-5), col="100", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sd_lowoffset_1000[-21,],
aes(x=sd, y=1e-6/abs(del_flux-1e-6), col="1000", linetype="Low offset"), linewidth =line_width)+
geom_line(data = dat_sd_lowoffset_100[-21,],
aes(x=sd, y=1e-6/abs(del_flux-1e-6), col="100", linetype="Low offset"), linewidth =line_width)+
scale_x_log10(name=NULL, limits=c(0.001,0.1), breaks = c(0.001, 0.01, 0.1), labels=c("0.001", "0.01", "0.1")) +
annotation_logticks(sides = "bl",short = unit(0.5, "mm"),
mid = unit(0.75, "mm"),
long = unit(1.25, "mm"),
outside=TRUE)+ coord_cartesian(clip="off")+
scale_y_log10(limits=c(0.0038,1), breaks=c(0.01, 0.1, 1), labels=c("0.01","0.1","1")) +
geom_hline(aes(yintercept =1), linetype="dotted", alpha=0.5, col="red", linewidth=line_width)+
scale_colour_manual(values=c("1000"="#9e9e9e","100"="#2298e6")) +
scale_linetype_manual(values=c("High offset"="solid", "Low offset"="dashed")) +
labs(y=expression(bold("Env.: Mut. deg. ratio at "*N[crit])))+
theme_Publication(base_size=text_size) +
theme(legend.position="none",
axis.title.x=element_blank(),  # remove x-axis for top row
axis.text.x=element_blank(),
axis.title.y=element_text(size=8),
plot.margin=margin(.5,.5,.5,.5))
#p3 #Ncrit
p3 <- ggplot() +
geom_line(data = dat_sd_highoffset_1000[-21,],
aes(x=sd, y=Ncrit, col="1000", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sd_highoffset_100[-21,],
aes(x=sd, y=Ncrit, col="100", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sd_lowoffset_1000[-21,],
aes(x=sd, y=Ncrit, col="1000", linetype="Low offset"), linewidth =line_width)+
geom_line(data = dat_sd_lowoffset_100[-21,],
aes(x=sd, y=Ncrit, col="100", linetype="Low offset"), linewidth =line_width)+
geom_point(aes(x=0.009487042205869916,y=1834.57),col = "#F05039",shape=42, size=7)+
scale_x_log10(name=expression(bold(-bar(s[d]))),  limits=c(0.001,0.1), breaks = c(0.001, 0.01, 0.1),
labels=c("0.001", "0.01", "0.1")) +
annotation_logticks(sides = "bl",short = unit(0.25, "mm"),
mid = unit(0.5, "mm"),
long = unit(1, "mm"),
outside=TRUE)+ coord_cartesian(clip="off")+
scale_y_log10(limits=c(120, 21000), breaks=c(300, 1000, 3000, 10000), labels = label_number(big.mark = "\u202F")) +
scale_colour_manual(values=c("1000"="#9e9e9e","100"="#2298e6")) +
scale_linetype_manual(values=c("High offset"="solid", "Low offset"="dashed")) +
labs(y=expression(bold(N[crit]))) +
theme_Publication(base_size=text_size) +
theme(legend.position="none",
plot.margin=margin(.5,.5,.5,.5))
#ben del ratio
#p4
p4 <- ggplot() +
geom_line(data = dat_sb_highoffset_1000,
aes(x=sb, y=bendelratio, col="1000", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sb_highoffset_100,
aes(x=sb, y=bendelratio, col="100", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sb_lowoffset_1000,
aes(x=sb, y=bendelratio, col="1000", linetype="Low offset"), linewidth =line_width)+
geom_line(data = dat_sb_lowoffset_100,
aes(x=sb, y=bendelratio, col="100", linetype="Low offset"), linewidth =line_width)+
geom_point(aes(x=0.001,y=0.853449),col = "#F05039",shape=42, size=7)+
scale_x_log10(name=NULL, breaks = c(0.001, 0.01), labels = c("0.001", "0.01")) +
annotation_logticks(sides = "bl",short = unit(0.25, "mm"),
mid = unit(0.5, "mm"),
long = unit(1, "mm"),
outside=TRUE)+ coord_cartesian(clip="off")+
geom_hline(aes(yintercept =1), linetype="dotted", alpha=0.5, col="red", linewidth=line_width)+
scale_y_log10(limits=c(0.35,18.5), breaks=c(1,3,10), labels=c("1","3","10")) +
scale_colour_manual(values=c("1000"="#9e9e9e","100"="#2298e6")) +
scale_linetype_manual(values=c("High offset"="solid", "Low offset"="dashed")) +
labs(y="Drought:Meltdown ratio") +
theme_Publication(base_size=text_size) +
theme(legend.position="none",
axis.title.x=element_blank(),  # remove x-axis for top row
axis.text.x=element_blank(),
axis.title.y=element_blank(),  # remove y-axis for top row
axis.text.y=element_blank(),
plot.margin=margin(.5,.5,.5,.5))
#p5 #offset del ratio
p5 <- ggplot() +
geom_line(data = dat_sb_highoffset_1000,
aes(x=sb, y=1.5e-5/abs(del_flux-1.5e-5), col="1000", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sb_highoffset_100,
aes(x=sb, y=1.5e-5/abs(del_flux-1.5e-5), col="100", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sb_lowoffset_1000,
aes(x=sb, y=1e-6/abs(del_flux-1e-6), col="1000", linetype="Low offset"), linewidth =line_width)+
geom_line(data = dat_sb_lowoffset_100,
aes(x=sb, y=1e-6/abs(del_flux-1e-6), col="100", linetype="Low offset"), linewidth =line_width)+
scale_x_log10(breaks = c(0.001, 0.01), labels = c("0.001", "0.01")) +
annotation_logticks(sides = "bl",short = unit(0.25, "mm"),
mid = unit(0.5, "mm"),
long = unit(1, "mm"),
outside=TRUE)+ coord_cartesian(clip="off")+
scale_y_log10(limits=c(0.0038,1), breaks=c(0.01, 0.1, 1), labels=c("0.01","0.1","1")) +
geom_hline(aes(yintercept =1), linetype="dotted", alpha=0.5, col="red", linewidth=line_width)+
scale_colour_manual(values=c("1000"="#9e9e9e","100"="#2298e6")) +
scale_linetype_manual(values=c("High offset"="solid", "Low offset"="dashed")) +
labs(y=expression("Env. ch. to mut. deg. ratio at "*N[crit])) +
theme_Publication(base_size=text_size) +
theme(legend.position="none",
axis.title.x=element_blank(),  # remove x-axis for top row
axis.text.x=element_blank(),
axis.title.y=element_blank(),  # remove y-axis for top row
axis.text.y=element_blank(),
plot.margin=margin(.5,.5,.5,.5))
#p6 #Ncrit
p6 <- ggplot() +
geom_line(data = dat_sb_highoffset_1000,
aes(x=sb, y=Ncrit, col="1000", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sb_highoffset_100,
aes(x=sb, y=Ncrit, col="100", linetype="High offset"), linewidth=line_width) +
geom_line(data = dat_sb_lowoffset_1000,
aes(x=sb, y=Ncrit, col="1000", linetype="Low offset"), linewidth =line_width)+
geom_line(data = dat_sb_lowoffset_100,
aes(x=sb, y=Ncrit, col="100", linetype="Low offset"), linewidth =line_width)+
geom_point(aes(x=0.001,y=1834.57),col = "#F05039",shape=42, size=7)+
scale_x_log10(name=expression(bold(s[b])), breaks = c(0.001, 0.01), labels = c("0.001", "0.01")) +
annotation_logticks(sides = "bl",short = unit(0.25, "mm"),
mid = unit(0.5, "mm"),
long = unit(1, "mm"),
outside=TRUE)+ coord_cartesian(clip="off")+
scale_y_log10(limits=c(120, 21000), breaks=c(300, 1000, 3000, 10000), labels = label_number(big.mark = "\u202F")) +
scale_colour_manual(values=c("1000"="#9e9e9e","100"="#2298e6")) +
scale_linetype_manual(values=c("High offset"="solid", "Low offset"="dashed")) +
labs(y=expression(N[crit])) +
theme_Publication(base_size=text_size) +
theme(legend.position="none",
axis.title.y=element_blank(),  # remove y-axis for top row
axis.text.y=element_blank(),
plot.margin=margin(.5,.5,.5,.5))
# Combine plots in 2 columns x 3 rows
combined <- (p1 | p4) / (p2 | p5) / (p3 | p6) +
plot_annotation(tag_levels = "a", tag_prefix = "(", tag_suffix = ")") &
theme(plot.tag = element_text(family="Times New Roman", face="italic", size=9))
# Save as Proceedings B single-column figure (88 mm = 3.46 inches)
tiff("figureS3_combined_1col.tiff",
width = 4, height = 6,  # adjust height for readability
units = "in", res = 600, compression = "lzw")
print(combined)
dev.off()
